import{Ba as F,Bb as B,Ca as _,Cb as j,Da as M,Db as z,Ea as N,Eb as A,Fb as v,Gb as f,Ib as m,L as G,a as R,d as g,nb as S,oa as k,qb as D,ra as w,sa as x,wb as $,yb as P,z as O}from"./chunk-IYURAQ6S.mjs";var J=R("accordion").parts("root","item","itemTrigger","itemContent","itemIndicator"),E=J.build(),V=e=>e.ids?.root??`accordion:${e.id}`,Q=(e,t)=>e.ids?.item?.(t)??`accordion:${e.id}:item:${t}`,H=(e,t)=>e.ids?.itemContent?.(t)??`accordion:${e.id}:content:${t}`,y=(e,t)=>e.ids?.itemTrigger?.(t)??`accordion:${e.id}:trigger:${t}`,W=e=>e.getById(V(e)),I=e=>{let a=`[data-controls][data-ownedby='${CSS.escape(V(e))}']:not([disabled])`;return k(W(e),a)},Y=e=>F(I(e)),Z=e=>_(I(e)),ee=(e,t)=>w(I(e),y(e,t)),te=(e,t)=>x(I(e),y(e,t));function U(e,t){let{send:a,context:n,prop:o,scope:r,computed:c}=e,u=n.get("focusedValue"),p=n.get("value"),T=o("multiple");function b(s){let i=s;!T&&i.length>1&&(i=[i[0]]),a({type:"VALUE.SET",value:i})}function l(s){return{expanded:p.includes(s.value),focused:u===s.value,disabled:!!(s.disabled??o("disabled"))}}return{focusedValue:u,value:p,setValue:b,getItemState:l,getRootProps(){return t.element({...E.root.attrs,dir:o("dir"),id:V(r),"data-orientation":o("orientation")})},getItemProps(s){let i=l(s);return t.element({...E.item.attrs,dir:o("dir"),id:Q(r,s.value),"data-state":i.expanded?"open":"closed","data-focus":g(i.focused),"data-disabled":g(i.disabled),"data-orientation":o("orientation")})},getItemContentProps(s){let i=l(s);return t.element({...E.itemContent.attrs,dir:o("dir"),role:"region",id:H(r,s.value),"aria-labelledby":y(r,s.value),hidden:!i.expanded,"data-state":i.expanded?"open":"closed","data-disabled":g(i.disabled),"data-focus":g(i.focused),"data-orientation":o("orientation")})},getItemIndicatorProps(s){let i=l(s);return t.element({...E.itemIndicator.attrs,dir:o("dir"),"aria-hidden":!0,"data-state":i.expanded?"open":"closed","data-disabled":g(i.disabled),"data-focus":g(i.focused),"data-orientation":o("orientation")})},getItemTriggerProps(s){let{value:i}=s,d=l(s);return t.button({...E.itemTrigger.attrs,type:"button",dir:o("dir"),id:y(r,i),"aria-controls":H(r,i),"data-controls":H(r,i),"aria-expanded":d.expanded,disabled:d.disabled,"data-orientation":o("orientation"),"aria-disabled":d.disabled,"data-state":d.expanded?"open":"closed","data-ownedby":V(r),onFocus(){d.disabled||a({type:"TRIGGER.FOCUS",value:i})},onBlur(){d.disabled||a({type:"TRIGGER.BLUR"})},onClick(h){d.disabled||(O()&&h.currentTarget.focus(),a({type:"TRIGGER.CLICK",value:i}))},onKeyDown(h){if(h.defaultPrevented||d.disabled)return;let K={ArrowDown(){c("isHorizontal")||a({type:"GOTO.NEXT",value:i})},ArrowUp(){c("isHorizontal")||a({type:"GOTO.PREV",value:i})},ArrowRight(){c("isHorizontal")&&a({type:"GOTO.NEXT",value:i})},ArrowLeft(){c("isHorizontal")&&a({type:"GOTO.PREV",value:i})},Home(){a({type:"GOTO.FIRST",value:i})},End(){a({type:"GOTO.LAST",value:i})}},X=G(h,{dir:o("dir"),orientation:o("orientation")}),L=K[X];L&&(L(h),h.preventDefault())}})}}}var{and:ae,not:oe}=$(),q={props({props:e}){return{collapsible:!1,multiple:!1,orientation:"vertical",defaultValue:[],...e}},initialState(){return"idle"},context({prop:e,bindable:t}){return{focusedValue:t(()=>({defaultValue:null,sync:!0,onChange(a){e("onFocusChange")?.({value:a})}})),value:t(()=>({defaultValue:e("defaultValue"),value:e("value"),onChange(a){e("onValueChange")?.({value:a})}}))}},computed:{isHorizontal:({prop:e})=>e("orientation")==="horizontal"},on:{"VALUE.SET":{actions:["setValue"]}},states:{idle:{on:{"TRIGGER.FOCUS":{target:"focused",actions:["setFocusedValue"]}}},focused:{on:{"GOTO.NEXT":{actions:["focusNextTrigger"]},"GOTO.PREV":{actions:["focusPrevTrigger"]},"TRIGGER.CLICK":[{guard:ae("isExpanded","canToggle"),actions:["collapse"]},{guard:oe("isExpanded"),actions:["expand"]}],"GOTO.FIRST":{actions:["focusFirstTrigger"]},"GOTO.LAST":{actions:["focusLastTrigger"]},"TRIGGER.BLUR":{target:"idle",actions:["clearFocusedValue"]}}}},implementations:{guards:{canToggle:({prop:e})=>!!e("collapsible")||!!e("multiple"),isExpanded:({context:e,event:t})=>e.get("value").includes(t.value)},actions:{collapse({context:e,prop:t,event:a}){let n=t("multiple")?N(e.get("value"),a.value):[];e.set("value",n)},expand({context:e,prop:t,event:a}){let n=t("multiple")?M(e.get("value"),a.value):[a.value];e.set("value",n)},focusFirstTrigger({scope:e}){Y(e)?.focus()},focusLastTrigger({scope:e}){Z(e)?.focus()},focusNextTrigger({context:e,scope:t}){let a=e.get("focusedValue");if(!a)return;ee(t,a)?.focus()},focusPrevTrigger({context:e,scope:t}){let a=e.get("focusedValue");if(!a)return;te(t,a)?.focus()},setFocusedValue({context:e,event:t}){e.set("focusedValue",t.value)},clearFocusedValue({context:e}){e.set("focusedValue",null)},setValue({context:e,event:t}){e.set("value",t.value)},coarseValue({context:e,prop:t}){!t("multiple")&&e.get("value").length>1&&(D("The value of accordion should be a single value when multiple is false."),e.set("value",[e.get("value")[0]]))}}}},ie=P()(["collapsible","dir","disabled","getRootNode","id","ids","multiple","onFocusChange","onValueChange","orientation","value","defaultValue"]),pe=S(ie),ne=P()(["value","disabled"]),ge=S(ne);var C=class extends z{initMachine(t){return new j(q,t)}initApi(){return U(this.machine.service,B)}render(){let t=this.el.querySelector('[data-scope="accordion"][data-part="root"]')??this.el;this.spreadProps(t,this.api.getRootProps());let a=this.getItemsList(),n=t.querySelectorAll('[data-scope="accordion"][data-part="item"]');for(let o=0;o<n.length;o++){let r=n[o],c=a[o];if(!c?.value)continue;let{value:u,disabled:p}=c;this.spreadProps(r,this.api.getItemProps({value:u,disabled:p}));let T=r.querySelector('[data-scope="accordion"][data-part="item-trigger"]');T&&this.spreadProps(T,this.api.getItemTriggerProps({value:u,disabled:p}));let b=r.querySelector('[data-scope="accordion"][data-part="item-indicator"]');b&&this.spreadProps(b,this.api.getItemIndicatorProps({value:u,disabled:p}));let l=r.querySelector('[data-scope="accordion"][data-part="item-content"]');l&&this.spreadProps(l,this.api.getItemContentProps({value:u,disabled:p}))}}getItemsList(){let t=this.el.getAttribute("data-items");if(!t)return[];try{return JSON.parse(t)}catch{return[]}}};var Ve={mounted(){let e=this.el,t=this.pushEvent.bind(this),a=new C(e,{id:e.id,...m(e,"controlled")?{value:f(e,"value")}:{defaultValue:f(e,"defaultValue")},collapsible:m(e,"collapsible"),multiple:m(e,"multiple"),orientation:v(e,"orientation",["horizontal","vertical"]),dir:A(e),onValueChange:n=>{let o=v(e,"onValueChange");o&&this.liveSocket.main.isConnected()&&t(o,{id:e.id,value:n.value??null});let r=v(e,"onValueChangeClient");r&&e.dispatchEvent(new CustomEvent(r,{bubbles:!0,detail:{id:e.id,value:n.value??null}}))},onFocusChange:n=>{let o=v(e,"onFocusChange");o&&this.liveSocket.main.isConnected()&&t(o,{id:e.id,value:n.value??null});let r=v(e,"onFocusChangeClient");r&&e.dispatchEvent(new CustomEvent(r,{bubbles:!0,detail:{id:e.id,value:n.value??null}}))}});a.init(),this.accordion=a,this.onSetValue=n=>{let{value:o}=n.detail;a.api.setValue(o)},e.addEventListener("phx:accordion:set-value",this.onSetValue),this.handlers=[],this.handlers.push(this.handleEvent("accordion_set_value",n=>{let o=n.accordion_id;o&&!(e.id===o||e.id===`accordion:${o}`)||a.api.setValue(n.value)})),this.handlers.push(this.handleEvent("accordion_value",()=>{this.pushEvent("accordion_value_response",{value:a.api.value})})),this.handlers.push(this.handleEvent("accordion_focused_value",()=>{this.pushEvent("accordion_focused_value_response",{value:a.api.focusedValue})}))},updated(){let e=m(this.el,"controlled");this.accordion?.updateProps({id:this.el.id,...e?{value:f(this.el,"value")}:{defaultValue:this.accordion?.api?.value??f(this.el,"defaultValue")},collapsible:m(this.el,"collapsible"),multiple:m(this.el,"multiple"),orientation:v(this.el,"orientation",["horizontal","vertical"]),dir:A(this.el)})},destroyed(){if(this.onSetValue&&this.el.removeEventListener("phx:accordion:set-value",this.onSetValue),this.handlers)for(let e of this.handlers)this.removeHandleEvent(e);this.accordion?.destroy()}};export{Ve as Accordion};
