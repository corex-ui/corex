import{a as $,f as j}from"./chunk-UBXVV7GZ.mjs";import{Bb as x,Cb as q,Db as W,Fb as v,Hb as m,I as C,Ib as p,M as D,N as I,O as L,Q as R,a as V,ba as N,d as s,gb as B,ma as U,nb as w,yb as _}from"./chunk-IYURAQ6S.mjs";var ne=V("angle-slider").parts("root","label","thumb","valueText","control","track","markerGroup","marker"),h=ne.build(),le=e=>e.ids?.root??`angle-slider:${e.id}`,K=e=>e.ids?.thumb??`angle-slider:${e.id}:thumb`,k=e=>e.ids?.hiddenInput??`angle-slider:${e.id}:input`,X=e=>e.ids?.control??`angle-slider:${e.id}:control`,oe=e=>e.ids?.valueText??`angle-slider:${e.id}:value-text`,G=e=>e.ids?.label??`angle-slider:${e.id}:label`,ie=e=>e.getById(k(e)),se=e=>e.getById(X(e)),S=e=>e.getById(K(e)),P=0,O=359;function J(e,t,a){let r=j(e.getBoundingClientRect()),i=$(r,t);return a!=null?i-a:i}function Q(e){return Math.min(Math.max(e,P),O)}function de(e,t){let a=Q(e),r=Math.ceil(a/t),i=Math.round(a/t);return r>=a/t?r*t===O?P:r*t:i*t}function F(e,t){return B(e,P,O,t)}function Y(e,t){let{state:a,send:r,context:i,prop:l,computed:d,scope:o}=e,g=a.matches("dragging"),u=i.get("value"),f=d("valueAsDegree"),b=l("disabled"),T=l("invalid"),E=l("readOnly"),y=d("interactive"),z=l("aria-label"),ee=l("aria-labelledby");return{value:u,valueAsDegree:f,dragging:g,setValue(n){r({type:"VALUE.SET",value:n})},getRootProps(){return t.element({...h.root.attrs,id:le(o),"data-disabled":s(b),"data-invalid":s(T),"data-readonly":s(E),style:{"--value":u,"--angle":f}})},getLabelProps(){return t.label({...h.label.attrs,id:G(o),htmlFor:k(o),"data-disabled":s(b),"data-invalid":s(T),"data-readonly":s(E),onClick(n){y&&(n.preventDefault(),S(o)?.focus())}})},getHiddenInputProps(){return t.element({type:"hidden",value:u,name:l("name"),id:k(o)})},getControlProps(){return t.element({...h.control.attrs,role:"presentation",id:X(o),"data-disabled":s(b),"data-invalid":s(T),"data-readonly":s(E),onPointerDown(n){if(!y||!C(n))return;let c=L(n),te=n.currentTarget,A=S(o),ae=D(n).composedPath(),re=A&&ae.includes(A),H=null;re&&(H=J(te,c)-u),r({type:"CONTROL.POINTER_DOWN",point:c,angularOffset:H}),n.stopPropagation()},style:{touchAction:"none",userSelect:"none",WebkitUserSelect:"none"}})},getThumbProps(){return t.element({...h.thumb.attrs,id:K(o),role:"slider","aria-label":z,"aria-labelledby":ee??G(o),"aria-valuemax":360,"aria-valuemin":0,"aria-valuenow":u,tabIndex:E||y?0:void 0,"data-disabled":s(b),"data-invalid":s(T),"data-readonly":s(E),onFocus(){r({type:"THUMB.FOCUS"})},onBlur(){r({type:"THUMB.BLUR"})},onKeyDown(n){if(!y)return;let c=I(n)*l("step");switch(n.key){case"ArrowLeft":case"ArrowUp":n.preventDefault(),r({type:"THUMB.ARROW_DEC",step:c});break;case"ArrowRight":case"ArrowDown":n.preventDefault(),r({type:"THUMB.ARROW_INC",step:c});break;case"Home":n.preventDefault(),r({type:"THUMB.HOME"});break;case"End":n.preventDefault(),r({type:"THUMB.END"});break}},style:{rotate:"var(--angle)"}})},getValueTextProps(){return t.element({...h.valueText.attrs,id:oe(o)})},getMarkerGroupProps(){return t.element({...h.markerGroup.attrs})},getMarkerProps(n){let c;return n.value<u?c="under-value":n.value>u?c="over-value":c="at-value",t.element({...h.marker.attrs,"data-value":n.value,"data-state":c,"data-disabled":s(b),style:{"--marker-value":n.value,rotate:"calc(var(--marker-value) * 1deg)"}})}}}var Z={props({props:e}){return{step:1,defaultValue:0,...e}},context({prop:e,bindable:t}){return{value:t(()=>({defaultValue:e("defaultValue"),value:e("value"),onChange(a){e("onValueChange")?.({value:a,valueAsDegree:`${a}deg`})}}))}},refs(){return{thumbDragOffset:null}},computed:{interactive:({prop:e})=>!(e("disabled")||e("readOnly")),valueAsDegree:({context:e})=>`${e.get("value")}deg`},watch({track:e,context:t,action:a}){e([()=>t.get("value")],()=>{a(["syncInputElement"])})},initialState(){return"idle"},on:{"VALUE.SET":{actions:["setValue"]}},states:{idle:{on:{"CONTROL.POINTER_DOWN":{target:"dragging",actions:["setThumbDragOffset","setPointerValue","focusThumb"]},"THUMB.FOCUS":{target:"focused"}}},focused:{on:{"CONTROL.POINTER_DOWN":{target:"dragging",actions:["setThumbDragOffset","setPointerValue","focusThumb"]},"THUMB.ARROW_DEC":{actions:["decrementValue","invokeOnChangeEnd"]},"THUMB.ARROW_INC":{actions:["incrementValue","invokeOnChangeEnd"]},"THUMB.HOME":{actions:["setValueToMin","invokeOnChangeEnd"]},"THUMB.END":{actions:["setValueToMax","invokeOnChangeEnd"]},"THUMB.BLUR":{target:"idle"}}},dragging:{entry:["focusThumb"],effects:["trackPointerMove"],on:{"DOC.POINTER_UP":{target:"focused",actions:["invokeOnChangeEnd","clearThumbDragOffset"]},"DOC.POINTER_MOVE":{actions:["setPointerValue"]}}}},implementations:{effects:{trackPointerMove({scope:e,send:t}){return U(e.getDoc(),{onPointerMove(a){t({type:"DOC.POINTER_MOVE",point:a.point})},onPointerUp(){t({type:"DOC.POINTER_UP"})}})}},actions:{syncInputElement({scope:e,context:t}){let a=ie(e);R(a,t.get("value").toString())},invokeOnChangeEnd({context:e,prop:t,computed:a}){t("onValueChangeEnd")?.({value:e.get("value"),valueAsDegree:a("valueAsDegree")})},setPointerValue({scope:e,event:t,context:a,prop:r,refs:i}){let l=se(e);if(!l)return;let d=i.get("thumbDragOffset"),o=J(l,t.point,d);a.set("value",de(o,r("step")))},setValueToMin({context:e}){e.set("value",P)},setValueToMax({context:e}){e.set("value",O)},setValue({context:e,event:t}){e.set("value",Q(t.value))},decrementValue({context:e,event:t,prop:a}){let r=F(e.get("value")-t.step,t.step??a("step"));e.set("value",r)},incrementValue({context:e,event:t,prop:a}){let r=F(e.get("value")+t.step,t.step??a("step"));e.set("value",r)},focusThumb({scope:e}){N(()=>{S(e)?.focus({preventScroll:!0})})},setThumbDragOffset({refs:e,event:t}){e.set("thumbDragOffset",t.angularOffset??null)},clearThumbDragOffset({refs:e}){e.set("thumbDragOffset",null)}}}},ue=_()(["aria-label","aria-labelledby","dir","disabled","getRootNode","id","ids","invalid","name","onValueChange","onValueChangeEnd","readOnly","step","value","defaultValue"]),fe=w(ue);var M=class extends W{initMachine(t){return new q(Z,t)}initApi(){return Y(this.machine.service,x)}render(){let t=this.el.querySelector('[data-scope="angle-slider"][data-part="root"]')??this.el;this.spreadProps(t,this.api.getRootProps());let a=this.el.querySelector('[data-scope="angle-slider"][data-part="label"]');a&&this.spreadProps(a,this.api.getLabelProps());let r=this.el.querySelector('[data-scope="angle-slider"][data-part="hidden-input"]');r&&this.spreadProps(r,this.api.getHiddenInputProps());let i=this.el.querySelector('[data-scope="angle-slider"][data-part="control"]');i&&this.spreadProps(i,this.api.getControlProps());let l=this.el.querySelector('[data-scope="angle-slider"][data-part="thumb"]');l&&this.spreadProps(l,this.api.getThumbProps());let d=this.el.querySelector('[data-scope="angle-slider"][data-part="value-text"]');d&&this.spreadProps(d,this.api.getValueTextProps());let o=this.el.querySelector('[data-scope="angle-slider"][data-part="marker-group"]');o&&this.spreadProps(o,this.api.getMarkerGroupProps()),this.el.querySelectorAll('[data-scope="angle-slider"][data-part="marker"]').forEach(g=>{let u=g.dataset.value;if(u==null)return;let f=Number(u);Number.isNaN(f)||this.spreadProps(g,this.api.getMarkerProps({value:f}))})}};var ke={mounted(){let e=this.el,t=m(e,"value"),a=m(e,"defaultValue"),r=p(e,"controlled"),i=new M(e,{id:e.id,...r&&t!==void 0?{value:t}:{defaultValue:a??0},step:m(e,"step")??1,disabled:p(e,"disabled"),readOnly:p(e,"readOnly"),invalid:p(e,"invalid"),name:v(e,"name"),dir:v(e,"dir",["ltr","rtl"]),onValueChange:l=>{let d=e.querySelector('[data-scope="angle-slider"][data-part="hidden-input"]');d&&(d.value=String(l.value),d.dispatchEvent(new Event("input",{bubbles:!0})),d.dispatchEvent(new Event("change",{bubbles:!0})));let o=v(e,"onValueChange");o&&!this.liveSocket.main.isDead&&this.liveSocket.main.isConnected()&&this.pushEvent(o,{value:l.value,valueAsDegree:l.valueAsDegree,id:e.id});let g=v(e,"onValueChangeClient");g&&e.dispatchEvent(new CustomEvent(g,{bubbles:!0,detail:{value:l,id:e.id}}))}});i.init(),this.angleSlider=i,this.handlers=[]},updated(){let e=m(this.el,"value"),t=p(this.el,"controlled");this.angleSlider?.updateProps({id:this.el.id,...t&&e!==void 0?{value:e}:{},step:m(this.el,"step")??1,disabled:p(this.el,"disabled"),readOnly:p(this.el,"readOnly"),invalid:p(this.el,"invalid"),name:v(this.el,"name")})},destroyed(){if(this.handlers)for(let e of this.handlers)this.removeHandleEvent(e);this.angleSlider?.destroy()}};export{ke as AngleSlider};
