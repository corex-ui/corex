import{b as R,c as A}from"./chunk-XQAZHZIC.mjs";import{B as H,Bb as O,Cb as F,Db as N,Eb as b,Fb as c,Ib as d,R as P,T as I,U as V,a as S,d as r,na as L,nb as q,wb as M,ya as _,yb as D}from"./chunk-IYURAQ6S.mjs";var Q=S("checkbox").parts("root","label","control","indicator"),f=Q.build(),K=e=>e.ids?.root??`checkbox:${e.id}`,w=e=>e.ids?.label??`checkbox:${e.id}:label`,U=e=>e.ids?.control??`checkbox:${e.id}:control`,m=e=>e.ids?.hiddenInput??`checkbox:${e.id}:input`,W=e=>e.getById(K(e)),k=e=>e.getById(m(e));function G(e,t){let{send:o,context:i,prop:s,computed:n,scope:h}=e,l=!!s("disabled"),E=!!s("readOnly"),B=!!s("required"),y=!!s("invalid"),x=!l&&i.get("focused"),$=!l&&i.get("focusVisible"),u=n("checked"),g=n("indeterminate"),J=i.get("checked"),p={"data-active":r(i.get("active")),"data-focus":r(x),"data-focus-visible":r($),"data-readonly":r(E),"data-hover":r(i.get("hovered")),"data-disabled":r(l),"data-state":g?"indeterminate":u?"checked":"unchecked","data-invalid":r(y),"data-required":r(B)};return{checked:u,disabled:l,indeterminate:g,focused:x,checkedState:J,setChecked(a){o({type:"CHECKED.SET",checked:a,isTrusted:!1})},toggleChecked(){o({type:"CHECKED.TOGGLE",checked:u,isTrusted:!1})},getRootProps(){return t.label({...f.root.attrs,...p,dir:s("dir"),id:K(h),htmlFor:m(h),onPointerMove(){l||o({type:"CONTEXT.SET",context:{hovered:!0}})},onPointerLeave(){l||o({type:"CONTEXT.SET",context:{hovered:!1}})},onClick(a){H(a)===k(h)&&a.stopPropagation()}})},getLabelProps(){return t.element({...f.label.attrs,...p,dir:s("dir"),id:w(h)})},getControlProps(){return t.element({...f.control.attrs,...p,dir:s("dir"),id:U(h),"aria-hidden":!0})},getIndicatorProps(){return t.element({...f.indicator.attrs,...p,dir:s("dir"),hidden:!g&&!u})},getHiddenInputProps(){return t.input({id:m(h),type:"checkbox",required:s("required"),defaultChecked:u,disabled:l,"aria-labelledby":w(h),"aria-invalid":y,name:s("name"),form:s("form"),value:s("value"),style:_,onFocus(){let a=R();o({type:"CONTEXT.SET",context:{focused:!0,focusVisible:a}})},onBlur(){o({type:"CONTEXT.SET",context:{focused:!1,focusVisible:!1}})},onClick(a){if(E){a.preventDefault();return}let T=a.currentTarget.checked;o({type:"CHECKED.SET",checked:T,isTrusted:!0})}})}}}var{not:j}=M(),X={props({props:e}){return{value:"on",...e,defaultChecked:e.defaultChecked??!1}},initialState(){return"ready"},context({prop:e,bindable:t}){return{checked:t(()=>({defaultValue:e("defaultChecked"),value:e("checked"),onChange(o){e("onCheckedChange")?.({checked:o})}})),fieldsetDisabled:t(()=>({defaultValue:!1})),focusVisible:t(()=>({defaultValue:!1})),active:t(()=>({defaultValue:!1})),focused:t(()=>({defaultValue:!1})),hovered:t(()=>({defaultValue:!1}))}},watch({track:e,context:t,prop:o,action:i}){e([()=>o("disabled")],()=>{i(["removeFocusIfNeeded"])}),e([()=>t.get("checked")],()=>{i(["syncInputElement"])})},effects:["trackFormControlState","trackPressEvent","trackFocusVisible"],on:{"CHECKED.TOGGLE":[{guard:j("isTrusted"),actions:["toggleChecked","dispatchChangeEvent"]},{actions:["toggleChecked"]}],"CHECKED.SET":[{guard:j("isTrusted"),actions:["setChecked","dispatchChangeEvent"]},{actions:["setChecked"]}],"CONTEXT.SET":{actions:["setContext"]}},computed:{indeterminate:({context:e})=>C(e.get("checked")),checked:({context:e})=>Y(e.get("checked")),disabled:({context:e,prop:t})=>!!t("disabled")||e.get("fieldsetDisabled")},states:{ready:{}},implementations:{guards:{isTrusted:({event:e})=>!!e.isTrusted},effects:{trackPressEvent({context:e,computed:t,scope:o}){if(!t("disabled"))return L({pointerNode:W(o),keyboardNode:k(o),isValidKey:i=>i.key===" ",onPress:()=>e.set("active",!1),onPressStart:()=>e.set("active",!0),onPressEnd:()=>e.set("active",!1)})},trackFocusVisible({computed:e,scope:t}){if(!e("disabled"))return A({root:t.getRootNode?.()})},trackFormControlState({context:e,scope:t}){return V(k(t),{onFieldsetDisabledChange(o){e.set("fieldsetDisabled",o)},onFormReset(){e.set("checked",e.initial("checked"))}})}},actions:{setContext({context:e,event:t}){for(let o in t.context)e.set(o,t.context[o])},syncInputElement({context:e,computed:t,scope:o}){let i=k(o);i&&(P(i,t("checked")),i.indeterminate=C(e.get("checked")))},removeFocusIfNeeded({context:e,prop:t}){t("disabled")&&e.get("focused")&&(e.set("focused",!1),e.set("focusVisible",!1))},setChecked({context:e,event:t}){e.set("checked",t.checked)},toggleChecked({context:e,computed:t}){let o=C(t("checked"))?!0:!t("checked");e.set("checked",o)},dispatchChangeEvent({computed:e,scope:t}){queueMicrotask(()=>{let o=k(t);I(o,{checked:e("checked")})})}}}};function C(e){return e==="indeterminate"}function Y(e){return C(e)?!1:!!e}var Z=D()(["defaultChecked","checked","dir","disabled","form","getRootNode","id","ids","invalid","name","onCheckedChange","readOnly","required","value"]),ce=q(Z);var v=class extends N{initMachine(t){return new F(X,t)}initApi(){return G(this.machine.service,O)}render(){let t=this.el.querySelector('[data-scope="checkbox"][data-part="root"]');if(!t)return;this.spreadProps(t,this.api.getRootProps());let o=t.querySelector(':scope > [data-scope="checkbox"][data-part="hidden-input"]');o&&this.spreadProps(o,this.api.getHiddenInputProps());let i=t.querySelector(':scope > [data-scope="checkbox"][data-part="label"]');i&&this.spreadProps(i,this.api.getLabelProps());let s=t.querySelector(':scope > [data-scope="checkbox"][data-part="control"]');if(s){this.spreadProps(s,this.api.getControlProps());let n=s.querySelector(':scope > [data-scope="checkbox"][data-part="indicator"]');n&&this.spreadProps(n,this.api.getIndicatorProps())}}};var pe={mounted(){let e=this.el,t=this.pushEvent.bind(this),o=new v(e,{id:e.id,...d(e,"controlled")?{checked:d(e,"checked")}:{defaultChecked:d(e,"defaultChecked")},disabled:d(e,"disabled"),name:c(e,"name"),form:c(e,"form"),value:c(e,"value"),dir:b(e),invalid:d(e,"invalid"),required:d(e,"required"),readOnly:d(e,"readOnly"),onCheckedChange:i=>{let s=c(e,"onCheckedChange");s&&!this.liveSocket.main.isDead&&this.liveSocket.main.isConnected()&&t(s,{checked:i.checked,id:e.id});let n=c(e,"onCheckedChangeClient");n&&e.dispatchEvent(new CustomEvent(n,{bubbles:!0,detail:{value:i,id:e.id}}))}});o.init(),this.checkbox=o,this.onSetChecked=i=>{let{checked:s}=i.detail;o.api.setChecked(s)},e.addEventListener("phx:checkbox:set-checked",this.onSetChecked),this.onToggleChecked=()=>{o.api.toggleChecked()},e.addEventListener("phx:checkbox:toggle-checked",this.onToggleChecked),this.handlers=[],this.handlers.push(this.handleEvent("checkbox_set_checked",i=>{let s=i.id;s&&s!==e.id||o.api.setChecked(i.checked)})),this.handlers.push(this.handleEvent("checkbox_toggle_checked",i=>{let s=i.id;s&&s!==e.id||o.api.toggleChecked()})),this.handlers.push(this.handleEvent("checkbox_checked",()=>{this.pushEvent("checkbox_checked_response",{value:o.api.checked})})),this.handlers.push(this.handleEvent("checkbox_focused",()=>{this.pushEvent("checkbox_focused_response",{value:o.api.focused})})),this.handlers.push(this.handleEvent("checkbox_disabled",()=>{this.pushEvent("checkbox_disabled_response",{value:o.api.disabled})}))},updated(){this.checkbox?.updateProps({id:this.el.id,...d(this.el,"controlled")?{checked:d(this.el,"checked")}:{defaultChecked:d(this.el,"defaultChecked")},disabled:d(this.el,"disabled"),name:c(this.el,"name"),form:c(this.el,"form"),value:c(this.el,"value"),dir:b(this.el),invalid:d(this.el,"invalid"),required:d(this.el,"required"),readOnly:d(this.el,"readOnly"),label:c(this.el,"label")})},destroyed(){if(this.onSetChecked&&this.el.removeEventListener("phx:checkbox:set-checked",this.onSetChecked),this.onToggleChecked&&this.el.removeEventListener("phx:checkbox:toggle-checked",this.onToggleChecked),this.handlers)for(let e of this.handlers)this.removeHandleEvent(e);this.checkbox?.destroy()}};export{pe as Checkbox};
