import{B as k,Bb as R,Cb as j,Db as D,Fb as g,Ib as d,X as A,a as w,ba as C,ca as T,d as m,ea as z,kb as p,nb as M,o as y,ua as N,va as L,yb as _}from"./chunk-IYURAQ6S.mjs";var $=w("collapsible").parts("root","trigger","content","indicator"),E=$.build(),F=e=>e.ids?.root??`collapsible:${e.id}`,S=e=>e.ids?.content??`collapsible:${e.id}:content`,G=e=>e.ids?.trigger??`collapsible:${e.id}:trigger`,u=e=>e.getById(S(e));function W(e,o){let{state:n,send:i,context:t,scope:a,prop:l}=e,r=n.matches("open")||n.matches("closing"),s=n.matches("open"),c=n.matches("closed"),{width:H,height:B}=t.get("size"),h=!!l("disabled"),f=l("collapsedHeight"),b=l("collapsedWidth"),I=f!=null,P=b!=null,x=I||P,q=!t.get("initial")&&s;return{disabled:h,visible:r,open:s,measureSize(){i({type:"size.measure"})},setOpen(v){n.matches("open")!==v&&i({type:v?"open":"close"})},getRootProps(){return o.element({...E.root.attrs,"data-state":s?"open":"closed",dir:l("dir"),id:F(a)})},getContentProps(){return o.element({...E.content.attrs,id:S(a),"data-collapsible":"","data-state":q?void 0:s?"open":"closed","data-disabled":m(h),"data-has-collapsed-size":m(x),hidden:!r&&!x,dir:l("dir"),style:{"--height":p(B),"--width":p(H),"--collapsed-height":p(f),"--collapsed-width":p(b),...c&&I&&{overflow:"hidden",minHeight:p(f),maxHeight:p(f)},...c&&P&&{overflow:"hidden",minWidth:p(b),maxWidth:p(b)}}})},getTriggerProps(){return o.element({...E.trigger.attrs,id:G(a),dir:l("dir"),type:"button","data-state":s?"open":"closed","data-disabled":m(h),"aria-controls":S(a),"aria-expanded":r||!1,onClick(v){v.defaultPrevented||h||i({type:s?"close":"open"})}})},getIndicatorProps(){return o.element({...E.indicator.attrs,dir:l("dir"),"data-state":s?"open":"closed","data-disabled":m(h)})}}}var V={initialState({prop:e}){return e("open")||e("defaultOpen")?"open":"closed"},context({bindable:e}){return{size:e(()=>({defaultValue:{height:0,width:0},sync:!0})),initial:e(()=>({defaultValue:!1}))}},refs(){return{cleanup:void 0,stylesRef:void 0}},watch({track:e,prop:o,action:n}){e([()=>o("open")],()=>{n(["setInitial","computeSize","toggleVisibility"])})},exit:["cleanupNode"],states:{closed:{effects:["trackTabbableElements"],on:{"controlled.open":{target:"open"},open:[{guard:"isOpenControlled",actions:["invokeOnOpen"]},{target:"open",actions:["setInitial","computeSize","invokeOnOpen"]}]}},closing:{effects:["trackExitAnimation"],on:{"controlled.close":{target:"closed"},"controlled.open":{target:"open"},open:[{guard:"isOpenControlled",actions:["invokeOnOpen"]},{target:"open",actions:["setInitial","invokeOnOpen"]}],close:[{guard:"isOpenControlled",actions:["invokeOnExitComplete"]},{target:"closed",actions:["setInitial","computeSize","invokeOnExitComplete"]}],"animation.end":{target:"closed",actions:["invokeOnExitComplete","clearInitial"]}}},open:{effects:["trackEnterAnimation"],on:{"controlled.close":{target:"closing"},close:[{guard:"isOpenControlled",actions:["invokeOnClose"]},{target:"closing",actions:["setInitial","computeSize","invokeOnClose"]}],"size.measure":{actions:["measureSize"]},"animation.end":{actions:["clearInitial"]}}}},implementations:{guards:{isOpenControlled:({prop:e})=>e("open")!=null},effects:{trackEnterAnimation:({send:e,scope:o})=>{let n,i=C(()=>{let t=u(o);if(!t)return;let a=y(t).animationName;if(!a||a==="none"){e({type:"animation.end"});return}let r=s=>{k(s)===t&&e({type:"animation.end"})};t.addEventListener("animationend",r),n=()=>{t.removeEventListener("animationend",r)}});return()=>{i(),n?.()}},trackExitAnimation:({send:e,scope:o})=>{let n,i=C(()=>{let t=u(o);if(!t)return;let a=y(t).animationName;if(!a||a==="none"){e({type:"animation.end"});return}let r=c=>{k(c)===t&&e({type:"animation.end"})};t.addEventListener("animationend",r);let s=L(t,{animationFillMode:"forwards"});n=()=>{t.removeEventListener("animationend",r),T(()=>s())}});return()=>{i(),n?.()}},trackTabbableElements:({scope:e,prop:o})=>{if(!o("collapsedHeight")&&!o("collapsedWidth"))return;let n=u(e);if(!n)return;let i=()=>{let r=A(n).map(s=>N(s,"inert",""));return()=>{r.forEach(s=>s())}},t=i(),a=z(n,{callback(){t(),t=i()}});return()=>{t(),a()}}},actions:{setInitial:({context:e,flush:o})=>{o(()=>{e.set("initial",!0)})},clearInitial:({context:e})=>{e.set("initial",!1)},cleanupNode:({refs:e})=>{e.set("stylesRef",null)},measureSize:({context:e,scope:o})=>{let n=u(o);if(!n)return;let{height:i,width:t}=n.getBoundingClientRect();e.set("size",{height:i,width:t})},computeSize:({refs:e,scope:o,context:n})=>{e.get("cleanup")?.();let i=C(()=>{let t=u(o);if(!t)return;let a=t.hidden;t.style.animationName="none",t.style.animationDuration="0s",t.hidden=!1;let l=t.getBoundingClientRect();n.set("size",{height:l.height,width:l.width}),n.get("initial")&&(t.style.animationName="",t.style.animationDuration=""),t.hidden=a});e.set("cleanup",i)},invokeOnOpen:({prop:e})=>{e("onOpenChange")?.({open:!0})},invokeOnClose:({prop:e})=>{e("onOpenChange")?.({open:!1})},invokeOnExitComplete:({prop:e})=>{e("onExitComplete")?.()},toggleVisibility:({prop:e,send:o})=>{o({type:e("open")?"controlled.open":"controlled.close"})}}}},J=_()(["dir","disabled","getRootNode","id","ids","collapsedHeight","collapsedWidth","onExitComplete","onOpenChange","defaultOpen","open"]),Z=M(J);var O=class extends D{initMachine(o){return new j(V,o)}initApi(){return W(this.machine.service,R)}render(){let o=this.el.querySelector('[data-scope="collapsible"][data-part="root"]');if(o){this.spreadProps(o,this.api.getRootProps());let n=o.querySelector('[data-scope="collapsible"][data-part="trigger"]');n&&this.spreadProps(n,this.api.getTriggerProps());let i=o.querySelector('[data-scope="collapsible"][data-part="content"]');i&&this.spreadProps(i,this.api.getContentProps())}}};var le={mounted(){let e=this.el,o=this.pushEvent.bind(this),n=new O(e,{id:e.id,...d(e,"controlled")?{open:d(e,"open")}:{defaultOpen:d(e,"defaultOpen")},disabled:d(e,"disabled"),dir:g(e,"dir",["ltr","rtl"]),onOpenChange:i=>{let t=g(e,"onOpenChange");t&&this.liveSocket.main.isConnected()&&o(t,{id:e.id,open:i.open});let a=g(e,"onOpenChangeClient");a&&e.dispatchEvent(new CustomEvent(a,{bubbles:!0,detail:{id:e.id,open:i.open}}))}});n.init(),this.collapsible=n,this.onSetOpen=i=>{let{open:t}=i.detail;n.api.setOpen(t)},e.addEventListener("phx:collapsible:set-open",this.onSetOpen),this.handlers=[],this.handlers.push(this.handleEvent("collapsible_set_open",i=>{let t=i.collapsible_id;t&&t!==e.id||n.api.setOpen(i.open)})),this.handlers.push(this.handleEvent("collapsible_open",()=>{this.pushEvent("collapsible_open_response",{value:n.api.open})}))},updated(){this.collapsible?.updateProps({id:this.el.id,...d(this.el,"controlled")?{open:d(this.el,"open")}:{defaultOpen:d(this.el,"defaultOpen")},disabled:d(this.el,"disabled"),dir:g(this.el,"dir",["ltr","rtl"])})},destroyed(){if(this.onSetOpen&&this.el.removeEventListener("phx:collapsible:set-open",this.onSetOpen),this.handlers)for(let e of this.handlers)this.removeHandleEvent(e);this.collapsible?.destroy()}};export{le as Collapsible};
