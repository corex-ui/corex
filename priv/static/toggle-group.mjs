import{B as O,Ba as H,Bb as D,Ca as R,Cb as N,Db as j,Fb as d,Gb as p,Ha as U,Ib as s,L as V,Oa as _,Pa as A,a as y,ba as h,d as v,k as S,nb as k,oa as w,ra as P,sa as B,tb as M,wb as x,yb as C,z as L}from"./chunk-IYURAQ6S.mjs";var Z=y("toggle-group").parts("root","item"),z=Z.build(),b=e=>e.ids?.root??`toggle-group:${e.id}`,ee=(e,t)=>e.ids?.item?.(t)??`toggle-group:${e.id}:${t}`,q=e=>e.getById(b(e)),F=e=>{let a=`[data-ownedby='${CSS.escape(b(e))}']:not([data-disabled])`;return w(q(e),a)},W=e=>H(F(e)),te=e=>R(F(e)),oe=(e,t,a)=>P(F(e),t,a),ae=(e,t,a)=>B(F(e),t,a);function $(e,t){let{context:a,send:o,prop:i,scope:l}=e,c=a.get("value"),f=i("disabled"),T=!i("multiple"),g=i("rovingFocus"),m=i("orientation")==="horizontal";function G(n){let r=ee(l,n.value);return{id:r,disabled:!!(n.disabled||f),pressed:!!c.includes(n.value),focused:a.get("focusedId")===r}}return{value:c,setValue(n){o({type:"VALUE.SET",value:n})},getRootProps(){return t.element({...z.root.attrs,id:b(l),dir:i("dir"),role:T?"radiogroup":"group",tabIndex:a.get("isTabbingBackward")?-1:0,"data-disabled":v(f),"data-orientation":i("orientation"),"data-focus":v(a.get("focusedId")!=null),style:{outline:"none"},onMouseDown(){f||o({type:"ROOT.MOUSE_DOWN"})},onFocus(n){f||n.currentTarget===O(n)&&(a.get("isClickFocus")||a.get("isTabbingBackward")||o({type:"ROOT.FOCUS"}))},onBlur(n){let r=n.relatedTarget;S(n.currentTarget,r)||f||o({type:"ROOT.BLUR"})}})},getItemState:G,getItemProps(n){let r=G(n),J=r.focused?0:-1;return t.button({...z.item.attrs,id:r.id,type:"button","data-ownedby":b(l),"data-focus":v(r.focused),disabled:r.disabled,tabIndex:g?J:void 0,role:T?"radio":void 0,"aria-checked":T?r.pressed:void 0,"aria-pressed":T?void 0:r.pressed,"data-disabled":v(r.disabled),"data-orientation":i("orientation"),dir:i("dir"),"data-state":r.pressed?"on":"off",onFocus(){r.disabled||o({type:"TOGGLE.FOCUS",id:r.id})},onClick(u){r.disabled||(o({type:"TOGGLE.CLICK",id:r.id,value:n.value}),L()&&u.currentTarget.focus({preventScroll:!0}))},onKeyDown(u){if(u.defaultPrevented||!S(u.currentTarget,O(u))||r.disabled)return;let I={Tab(Q){let Y=Q.shiftKey;o({type:"TOGGLE.SHIFT_TAB",isShiftTab:Y})},ArrowLeft(){!g||!m||o({type:"TOGGLE.FOCUS_PREV"})},ArrowRight(){!g||!m||o({type:"TOGGLE.FOCUS_NEXT"})},ArrowUp(){!g||m||o({type:"TOGGLE.FOCUS_PREV"})},ArrowDown(){!g||m||o({type:"TOGGLE.FOCUS_NEXT"})},Home(){g&&o({type:"TOGGLE.FOCUS_FIRST"})},End(){g&&o({type:"TOGGLE.FOCUS_LAST"})}}[V(u)];I&&(I(u),u.key!=="Tab"&&u.preventDefault())}})}}}var{not:K,and:ie}=x(),X={props({props:e}){return{defaultValue:[],orientation:"horizontal",rovingFocus:!0,loopFocus:!0,deselectable:!0,...e}},initialState(){return"idle"},context({prop:e,bindable:t}){return{value:t(()=>({defaultValue:e("defaultValue"),value:e("value"),onChange(a){e("onValueChange")?.({value:a})}})),focusedId:t(()=>({defaultValue:null})),isTabbingBackward:t(()=>({defaultValue:!1})),isClickFocus:t(()=>({defaultValue:!1})),isWithinToolbar:t(()=>({defaultValue:!1}))}},computed:{currentLoopFocus:({context:e,prop:t})=>t("loopFocus")&&!e.get("isWithinToolbar")},entry:["checkIfWithinToolbar"],on:{"VALUE.SET":{actions:["setValue"]},"TOGGLE.CLICK":{actions:["setValue"]},"ROOT.MOUSE_DOWN":{actions:["setClickFocus"]}},states:{idle:{on:{"ROOT.FOCUS":{target:"focused",guard:K(ie("isClickFocus","isTabbingBackward")),actions:["focusFirstToggle","clearClickFocus"]},"TOGGLE.FOCUS":{target:"focused",actions:["setFocusedId"]}}},focused:{on:{"ROOT.BLUR":{target:"idle",actions:["clearIsTabbingBackward","clearFocusedId","clearClickFocus"]},"TOGGLE.FOCUS":{actions:["setFocusedId"]},"TOGGLE.FOCUS_NEXT":{actions:["focusNextToggle"]},"TOGGLE.FOCUS_PREV":{actions:["focusPrevToggle"]},"TOGGLE.FOCUS_FIRST":{actions:["focusFirstToggle"]},"TOGGLE.FOCUS_LAST":{actions:["focusLastToggle"]},"TOGGLE.SHIFT_TAB":[{guard:K("isFirstToggleFocused"),target:"idle",actions:["setIsTabbingBackward"]},{actions:["setIsTabbingBackward"]}]}}},implementations:{guards:{isClickFocus:({context:e})=>e.get("isClickFocus"),isTabbingBackward:({context:e})=>e.get("isTabbingBackward"),isFirstToggleFocused:({context:e,scope:t})=>e.get("focusedId")===W(t)?.id},actions:{setIsTabbingBackward({context:e}){e.set("isTabbingBackward",!0)},clearIsTabbingBackward({context:e}){e.set("isTabbingBackward",!1)},setClickFocus({context:e}){e.set("isClickFocus",!0)},clearClickFocus({context:e}){e.set("isClickFocus",!1)},checkIfWithinToolbar({context:e,scope:t}){let a=q(t)?.closest("[role=toolbar]");e.set("isWithinToolbar",!!a)},setFocusedId({context:e,event:t}){e.set("focusedId",t.id)},clearFocusedId({context:e}){e.set("focusedId",null)},setValue({context:e,event:t,prop:a}){M(t,["value"]);let o=e.get("value");A(t.value)?o=t.value:a("multiple")?o=U(o,t.value):o=_(o,[t.value])&&a("deselectable")?[]:[t.value],e.set("value",o)},focusNextToggle({context:e,scope:t,prop:a}){h(()=>{let o=e.get("focusedId");o&&oe(t,o,a("loopFocus"))?.focus({preventScroll:!0})})},focusPrevToggle({context:e,scope:t,prop:a}){h(()=>{let o=e.get("focusedId");o&&ae(t,o,a("loopFocus"))?.focus({preventScroll:!0})})},focusFirstToggle({scope:e}){h(()=>{W(e)?.focus({preventScroll:!0})})},focusLastToggle({scope:e}){h(()=>{te(e)?.focus({preventScroll:!0})})}}}},re=C()(["dir","disabled","getRootNode","id","ids","loopFocus","multiple","onValueChange","orientation","rovingFocus","value","defaultValue","deselectable"]),fe=k(re),se=C()(["value","disabled"]),ve=k(se);var E=class extends j{initMachine(t){return new N(X,t)}initApi(){return $(this.machine.service,D)}render(){let t=this.el.querySelector('[data-scope="toggle-group"][data-part="root"]');if(!t)return;this.spreadProps(t,this.api.getRootProps());let a=this.el.querySelectorAll('[data-scope="toggle-group"][data-part="item"]');for(let o=0;o<a.length;o++){let i=a[o],l=d(i,"value");if(!l)continue;let c=s(i,"disabled");this.spreadProps(i,this.api.getItemProps({value:l,disabled:c}))}}};var ke={mounted(){let e=this.el,t=this.pushEvent.bind(this),a={id:e.id,...s(e,"controlled")?{value:p(e,"value")}:{defaultValue:p(e,"defaultValue")},defaultValue:p(e,"defaultValue"),deselectable:s(e,"deselectable"),loopFocus:s(e,"loopFocus"),rovingFocus:s(e,"rovingFocus"),disabled:s(e,"disabled"),multiple:s(e,"multiple"),orientation:d(e,"orientation",["horizontal","vertical"]),dir:d(e,"dir",["ltr","rtl"]),onValueChange:i=>{let l=d(e,"onValueChange");l&&!this.liveSocket.main.isDead&&this.liveSocket.main.isConnected()&&t(l,{value:i.value,id:e.id});let c=d(e,"onValueChangeClient");c&&e.dispatchEvent(new CustomEvent(c,{bubbles:!0,detail:{value:i.value,id:e.id}}))}},o=new E(e,a);o.init(),this.toggleGroup=o,this.onSetValue=i=>{let{value:l}=i.detail;o.api.setValue(l)},e.addEventListener("phx:toggle-group:set-value",this.onSetValue),this.handlers=[],this.handlers.push(this.handleEvent("toggle-group_set_value",i=>{let l=i.id;l&&l!==e.id||o.api.setValue(i.value)})),this.handlers.push(this.handleEvent("toggle-group:value",()=>{this.pushEvent("toggle-group:value_response",{value:o.api.value})}))},updated(){this.toggleGroup?.updateProps({...s(this.el,"controlled")?{value:p(this.el,"value")}:{defaultValue:p(this.el,"defaultValue")},deselectable:s(this.el,"deselectable"),loopFocus:s(this.el,"loopFocus"),rovingFocus:s(this.el,"rovingFocus"),disabled:s(this.el,"disabled"),multiple:s(this.el,"multiple"),orientation:d(this.el,"orientation",["horizontal","vertical"]),dir:d(this.el,"dir",["ltr","rtl"])})},destroyed(){if(this.onSetValue&&this.el.removeEventListener("phx:toggle-group:set-value",this.onSetValue),this.handlers)for(let e of this.handlers)this.removeHandleEvent(e);this.toggleGroup?.destroy()}};export{ke as ToggleGroup};
